id: build-docker-1
namespace: demo

tasks:
  - id: git
    type: io.kestra.core.tasks.flows.WorkingDirectory
    tasks:
      - id: clone
        type: io.kestra.plugin.git.Clone
        url: https://github.com/christianlempa/hackbox
        branch: main

      - id: build
        type: io.kestra.plugin.docker.Build
        dockerfile: "src/Dockerfile"
        tags: 
          - xcad2k/hackbox-test:latest
        push: true
        credentials:
          registry: https://index.docker.io/v1/ 
          username: "{{ secret('DOCKERHUB_USERNAME') }}"
          password: "{{ secret('DOCKERHUB_PASSWORD') }}"
